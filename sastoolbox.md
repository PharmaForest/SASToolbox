# Documentation for the `SASToolbox` package.
  
----------------------------------------------------------------
 
 *SASToolbox package* 
  
----------------------------------------------------------------
 
### Version information:
  
- Package: SASToolbox
- Version: 1.0.0
- Generated: 2025-09-18T17:10:36
- Author(s): Shingo Suzuki(shingo.suzuki@sas.com)
- Maintainer(s): Shingo Suzuki(shingo.suzuki@sas.com)
- License: SAS
- File SHA256: `F*3E7D318938CC2DC44A362DE4D50E4D4105ED38E4DBDFD22B4606F9310183AA7D` for this version
- Content SHA256: `C*8EFAAE14AA2EA3B28A23167C682D5F976A64AB165096F010461F53EFB0BE9787` for this version
  
---
 
# The `SASToolbox` package, version: `1.0.0`;
  
---
 
# The SASToolbox package [ver. 1.0] <a name="sastoolbox-package"></a> ###############################################
This package provides sas macros which accelerate your business with sas language.

This package provides the following 4 sas macros:
1. IncludeAll macro which includes all .sas files in the specified directory and its sub-directories.

Typical usage of "IncludeAll" macro is shown in below.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  %IncludeAll(/tmp/program)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
The all .sas programs contaied in /tmp/program and its sub-directories will be included.
See the help for the `IncludeAll` macro to find more examples. 

2. SetUTF8 macro which changes encoding of datasets to UTF8 in specified directory at once.
Typical usage of "trancd2u8_d" macro is shown in below.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  %trancd2u8_d(/tmp/program)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 
3. Read_csv_in_folder macro which makes datasets from all csv files in specified directory at once.
 
Typical usage of "Read_csv_in_folder" macro is shown in below.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  %Read_csv_in_folder(path="/example/homes/SampleUser/SASPac/tmp1_csvFiles")
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
All .csv file(s) to be imported exists in a folder of "/example/homes/SampleUser/SASPac/tmp1_csvFiles".
See the help for the `Read_csv_in_folder` macro to find more examples.
 
4. Read_excel_in_folder macro which makes datasets from all excel files in specified directory at once.
 
Typical usage of "Read_excel_in_folder" macro is shown in below.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  %Read_excel_in_folder(path="/example/homes/SampleUser/SASPac/tmp1_excelFiles")
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
All .xslx file(s) to be imported exists in a folder of "/example/homes/SampleUser/SASPac/tmp1_excelFiles".
See the help for the `Read_excel_in_folder` macro to find more examples.
-----------------------------------------------------------------------------------------------------------------------------------

### Content ###################################################################

SASToolbox package contains the following components:

1. `IncludeAll` macro - the main macro available for the User
2. `Read_csv_in_folder`- the main macro available for the User
3. `Read_excel_in_folder` - the main macro available for the User
3. `trancd2u8_d` - the main macro available for the User
5. `Prv_IAI__DoIncludingProcess` internal macro used by IncludeAll macro
6. `Prv_IAI__GetContentsHelper` internal macro used by IncludeAll macro
7. `Prv_IAI__IncludeSASFileHalper` internal macro used by IncludeAll macro
8. `Prv_IAI__IncludeSASFile` internal macro used by IncludeAll macro
9. `Prv_IAI__MakeSASFileList` internal macro used by IncludeAll macro

  
---
 
  
---
 
Required SAS Components: 
  - Base SAS Software
  
---
 
 
--------------------------------------------------------------------
 
*SAS package generated by SAS Package Framework, version `20250729`*
 
--------------------------------------------------------------------
 
# The `SASToolbox` package content
The `SASToolbox` package consists of the following content:
 
1. [`%includeall()` macro ](#includeall-macro-1 )
2. [`%prv_iai__do_including_process()` macro ](#prviaidoincludingprocess-macro-2 )
3. [`%prv_iai__get_contents_helper()` macro ](#prviaigetcontentshelper-macro-3 )
4. [`%prv_iai__include_file_helper()` macro ](#prviaiincludefilehelper-macro-4 )
5. [`%prv_iai__include_sas_file()` macro ](#prviaiincludesasfile-macro-5 )
6. [`%prv_iai__make_sas_file_list()` macro ](#prviaimakesasfilelist-macro-6 )
7. [`%read_csv_in_folder()` macro ](#readcsvinfolder-macro-7 )
8. [`%read_excel_in_folder()` macro ](#readexcelinfolder-macro-8 )
9. [`%trancd2u8_d()` macro ](#trancd2u8d-macro-9 )
  
 
10. [License note](#license)
  
---
 
## `%includeall()` macro <a name="includeall-macro-1"></a> ######

`%IncludeAll` is a macro to include all .sas file(s) in specified direcotry and its sub-direcotries.

### Parameters

	- i_dir_path             : (Positional, Required)Full path of directory where .sas files to be included stored
	- i_is_recursive =       : (Keyword, Optional)Flag to specify if .sas files in sub-directories of "i_dir_path" will be included or not
	- i_exc_dirname_regex =  : (Keyword, Optional)Regular expression for directory name to be excluded.
	- i_exc_filename_regex = : (Keyword, Optional)Regular expression for file name(without extension) to be excluded.
	- i_leading_files =      : (Keyword, Optional)List of files to be included preferentially
	- i_trailing_files =     : (Keyword, Optional)List of files to be included lastly
	- i_is_verbose =         : (Keyword, Optional)Flag of verbose log (defulat: 0)
	- i_is_debug_mode =      : (Keyword, Optional)Flag of debug mode (default: 0))

### Sample code

1. Including all .sas file(s) in "/tmp/source" and its sub-direcotries.
~~~sas
%IncludeAll(/tmp/source)
~~~

2. Including all .sas file(s) in "/tmp/source" (not in sub-direcotries).
~~~sas
%IncludeAll(/tmp/source
              , i_is_recursive = 0)
~~~

3. Including all .sas file(s) in "/tmp/source" but sub-direcotries whose name begins with "test_" are excluded.
~~~sas
%IncludeAll(/tmp/source
              , i_exc_dirname_regex = /^test_/)
~~~

4. Including all .sas file(s) in "/tmp/source" and in sub-direcotries but its file name ends with "_bk" are excluded.
~~~sas
%IncludeAll(/tmp/source
              , i_exc_filename_regex = /_bk$/)
~~~

5. Including all .sas file(s) in "/tmp/source" and in sub-direcotries but its directory name starts with "test_" are excluded.
~~~sas
%IncludeAll(/tmp/source
              , i_exc_filename_regex = /^test_/)
~~~

6. Including all .sas file(s) in "/tmp/source" and in sub-direcotries.
.sas file "first.sas" will be included first and .sas file "last1.sas" and "last2.sas" will be included last.
~~~sas
%IncludeAll(/tmp/source
              , i_leading_files = /tmp/source/first.sas
				  , i_trailing_files = /tmp/source/last1.sas|/tmp/source/last2.sas)
~~~

7. Including all .sas file(s) in "/tmp/source" and in sub-direcotries. Verbose log will be output.
~~~sas
%IncludeAll(/tmp/source
              , i_is_verbose = 1)
~~~

8. Including all .sas file(s) in "/tmp/source" with DEBUG mode(RELEASE code will be commented out when including).
Note: When "i_is_debug_mode" is omitted, DEBUG code will be commented out(it is treated as RELEASE mode)
~~~sas
%IncludeAll(/tmp/source
              , i_is_debug_mode = 1)
~~~

How to specify "DEBUG/RELEAS" code in .sas file:
Single line:
- The line ends with commend contains #DEBUG# are recognized as DEBUG code (line 2 in the following sample)
- The line ends with commend contains #RELEASE# are recognized as RELEASE code (line 3 in the following sample)

Block
- The lines between comment contains "#DEBUG-" and "-DEBUG#" are recognized as DEBUG code (line 4 - 8 in the following sample)
- The lines between comment contains "#RELEASE-" and "-RELEASE#" are recognized as RELEASE code (line 9 - 13 in the following sample)
~~~sas
/* 1 .   %put SASPackage "IncludeAllIn" Test (Example4);
/* 2 .   %put This is DEBUG Message; /* #DEBUG# */
/* 3 .   %put This is RELEASE Message; /* #RELEASE# */
/* 4 .   /* #DEBUG- */
/* 5 .   data WORK.example4;
/* 6 .      set SASHELP.class;
/* 7 .   run;
/* 8 .   /* -DEBUG# */
/* 9 .   /* #RELEASE- */
/* 10.   data WORK.example4;
/* 11.      set SASHELP.cars;
/* 12.   run;
/* 13.   /* -RELEASE# */
/* 14.
~~~
  
---
 
## `%prv_iai__do_including_process()` macro <a name="prviaidoincludingprocess-macro-2"></a> ######

[Internal used only]
This macro is called from IncludeAllIn macro.

  
---
 
## `%prv_iai__get_contents_helper()` macro <a name="prviaigetcontentshelper-macro-3"></a> ######

[Internal used only]
This macro is called from Prv_IAI__MakeSASFileList macro.

  
---
 
## `%prv_iai__include_file_helper()` macro <a name="prviaiincludefilehelper-macro-4"></a> ######

[Internal used only]
This macro is called from Prv_IAI__IncludeSASFile macro.

  
---
 
## `%prv_iai__include_sas_file()` macro <a name="prviaiincludesasfile-macro-5"></a> ######

[Internal used only]
This macro is called from Prv_IAI__DoIncludingProcess macro.

  
---
 
## `%prv_iai__make_sas_file_list()` macro <a name="prviaimakesasfilelist-macro-6"></a> ######

[Internal used only]
This macro is called from IncludeAllIn macro.

  
---
 
## `%read_csv_in_folder()` macro <a name="readcsvinfolder-macro-7"></a> ######

`%Read_csv_in_folder` is a macro to import all CSV files in the specified directory as individual SAS datasets in bulk.
Each CSV file will be imported as a SAS dataset with the same name and saved in the work library.
If the filename exceeds 32 characters, that file will be skipped, but the others will be processed.
 
### Parameters

	- path : Full path to the folder where the CSV files are stored. The folder must contain only CSV files.
 
### Sample code
 
All .csv file(s) to be imported exists in a folder of "/example/homes/SampleUser/SASPac/tmp1_csvFiles".
~~~sas
%Read_csv_in_folder(path="/example/homes/SampleUser/SASPac/tmp1_csvFiles")
~~~
 
  
---
 
## `%read_excel_in_folder()` macro <a name="readexcelinfolder-macro-8"></a> ######

`%Read_excel_in_folder` is a macro to import all excel files in the specified directory as individual SAS datasets in bulk.
Each excel file will be imported as a SAS dataset with the same name and saved in the work library.
If the filename exceeds 32 characters, that file will be skipped, but the others will be processed.

Note:
　Only the first sheet of each excel file will be imported.
 
### Parameters

	- path : Full path to the folder where the excel files are stored. The folder must contain only excel files.
 
### Sample code
 
All .xlsx file(s) to be imported exists in a folder of "/example/homes/SampleUser/SASPac/tmp1_excelFiles".
~~~sas
%Read_excel_in_folder(path="/example/homes/SampleUser/SASPac/tmp1_excelFiles")
~~~

  
---
 
## `%trancd2u8_d()` macro <a name="trancd2u8d-macro-9"></a> ######

`%trancd2u8_d` is a macro to change encoding of dataset to UTF8.
 
### Parameters

	- directory_path     : directory path contains datasets to be processed.
	- transcode_dir_path : directory path where processed datasets will be stored.
	- compress_yn        : compress option
	- contents_yn        : ******
	- length_obs        : ******
 
### Sample code
 

  
---
 
  
---
 
# License <a name="license"></a> ######
 
	Copyright (c) [2025] [Shingo Suzuki]

Permission is hereby granted, free of charge, to any person obtaining a copy   
of this software and associated documentation files (the "Software"), to deal    
in the Software without restriction, including without limitation the rights   
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell   
copies of the Software, and to permit persons to whom the Software is   
furnished to do so, subject to the following conditions:                      
                                                                                
The above copyright notice and this permission notice shall be included       
in all copies or substantial portions of the Software.                        
                                                                                
THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR    
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,      
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE   
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER        
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, 
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE 
SOFTWARE.
  
---
 
